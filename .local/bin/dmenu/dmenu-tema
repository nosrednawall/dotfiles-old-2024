#!/bin/bash

solarized_dark=" Solarized Dark"
solarized_light=" Solarized Light"

# Variable passed to dmenu
options="$solarized_dark\n$solarized_light"

chosen="$(echo -e "$options" | dmenu -p "Tema menu " )"
case $chosen in
    $solarized_dark)
    # Arquivo variavel
    	sed -i 's|^export THEME_MODE=.*|export THEME_MODE="Solarized"|' ~/.dotfiles/.theme_selected
        sed -i 's|^export COLOR_MODE=.*|export COLOR_MODE="Dark"|' ~/.dotfiles/.theme_selected

    # Altero as configuracoes do gtk
    	sed -i 's/^gtk-theme-name=.*/gtk-theme-name=NumixSolarizedDarkCyan/' ~/.dotfiles/.config/gtk-3.0/settings.ini
        sed -i 's/^gtk-icon-theme-name=.*/gtk-icon-theme-name= Numix-Circle/' ~/.dotfiles/.config/gtk-3.0/settings.ini

    # Suckless
        sed -i 's|^#include "themes/.*|#include "themes/solarized_dark.h"|' ~/.dotfiles/.config/suckless/dwm/config.def.h
        sed -i 's|^#include "themes/.*|#include "themes/solarized_dark.h"|' ~/.dotfiles/.config/suckless/st/config.def.h
        sed -i 's|^#include "themes/.*|#include "themes/solarized_dark.h"|' ~/.dotfiles/.config/suckless/dmenu/config.def.h
	;;
    $solarized_light)
    # Arquivo variavel
    	sed -i 's|^export THEME_MODE=.*|export THEME_MODE="Solarized"|' ~/.dotfiles/.theme_selected
        sed -i 's|^export COLOR_MODE=.*|export COLOR_MODE="Light"|' ~/.dotfiles/.theme_selected

    # Altero as configuraçoes do gtk
		sed -i 's/^gtk-theme-name=.*/gtk-theme-name=NumixSolarizedLightCyan/' ~/.dotfiles/.config/gtk-3.0/settings.ini
        sed -i 's/^gtk-icon-theme-name=.*/gtk-icon-theme-name=Numix-Circle-Light/' ~/.dotfiles/.config/gtk-3.0/settings.ini

    # Suckless
        sed -i 's|^#include "themes/.*|#include "themes/solarized_light.h"|' ~/.dotfiles/.config/suckless/dwm/config.def.h
        sed -i 's|^#include "themes/.*|#include "themes/solarized_light.h"|' ~/.dotfiles/.config/suckless/st/config.def.h
        sed -i 's|^#include "themes/.*|#include "themes/solarized_light.h"|' ~/.dotfiles/.config/suckless/dmenu/config.def.h
	;;
esac

# Compila dwm
cd $HOME/.dotfiles/.config/suckless/dwm
rm config.h
make
SUDO_ASKPASS=/usr/bin/ssh-askpass sudo make clean install

# Compila st
cd $HOME/.dotfiles/.config/suckless/st
rm config.h
make
SUDO_ASKPASS=/usr/bin/ssh-askpass sudo make clean install

# Compila dmenu
cd $HOME/.dotfiles/.config/suckless/dmenu
rm config.h
make
SUDO_ASKPASS=/usr/bin/ssh-askpass sudo make clean install

# Opcionalmente reinicie as aplicações para aplicar o novo tema
# pkill -USR1 dwm
pkill -USR1 dunst

# Restart dwm
xdotool key Super_L+shift+r
